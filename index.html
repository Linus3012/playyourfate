<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Play Your Fate</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #05060a;
      --accent: #a855f7;
      --accent-soft: rgba(168, 85, 247, 0.25);
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --border-subtle: #1f2933;
      --error: #f87171;
      --radius-lg: 18px;
      --radius-xl: 26px;
      --shadow-soft: 0 18px 45px rgba(0,0,0,0.6);
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #05060a 55%);
      color: var(--text-main);
      text-align: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 520px;
    }

    .card {
      background: linear-gradient(145deg, #0c0e16, #05060a 60%, #111827);
      border-radius: var(--radius-xl);
      padding: 30px 24px 24px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.15);
    }

    h1 {
      margin: 8px 0 6px;
      font-size: 26px;
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 14px;
      margin-bottom: 20px;
    }

    .pill-row {
      display: flex;
      gap: 7px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 20px;
    }

    .pill {
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.25);
      font-size: 11px;
      color: var(--text-muted);
      background: rgba(15,23,42,0.9);
    }

    .input-section {
      background: rgba(15, 23, 42, 0.92);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148,163,184,0.25);
      padding: 18px;
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
      align-items: center;
    }

    input {
      padding: 10px 14px;
      width: 100%;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.35);
      background: #020617;
      color: var(--text-main);
      font-size: 15px;
    }

    input:focus {
      border-color: var(--accent);
      outline: none;
      box-shadow: 0 0 0 2px rgba(168,85,247,0.25);
    }

    button {
      border: none;
      background: var(--accent);
      color: white;
      padding: 11px 18px;
      font-weight: 600;
      border-radius: 999px;
      cursor: pointer;
      box-shadow: 0 10px 22px rgba(168,85,247,0.45);
      transition: 0.15s;
      white-space: nowrap;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 28px rgba(168,85,247,0.55);
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 8px 18px rgba(15,23,42,0.9);
    }

    .error {
      color: var(--error);
      margin-top: 12px;
      font-size: 14px;
    }

    .result {
      margin-top: 22px;
      background: radial-gradient(circle at top right, var(--accent-soft), rgba(15,23,42,0.94));
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148,163,184,0.25);
      padding: 18px;
      text-align: left;
    }

    .result-text {
      font-size: 17px;
      margin-bottom: 8px;
    }

    .result-meta {
      font-size: 13px;
      color: var(--text-muted);
    }

    .tags {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .tag {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.4);
      color: var(--text-muted);
    }

    @media (max-width: 480px) {
      .input-section {
        grid-template-columns: 1fr;
      }
      button {
        width: 100%;
      }
    }
  </style>
</head>

<body>
<div class="container">
  <div class="card">
    <h1>Play Your Fate</h1>
    <p class="subtitle">
      Du ziehst eine Karte ‚Äì das System gibt dir eine kurze, klare Empfehlung.
    </p>

    <div class="pill-row">
      <div class="pill">‚ù§Ô∏è Herz ¬∑ Beziehungen</div>
      <div class="pill">‚úö Kreuz ¬∑ Herausforderungen &amp; Logik</div>
      <div class="pill">üî± Schaufel ¬∑ Entscheidungen &amp; Verantwortung</div>
      <div class="pill">‚ô¶Ô∏è Ecken ¬∑ Action &amp; Umsetzung</div>
    </div>

    <div class="input-section">
      <input id="kartenInput" placeholder="z. B.: herz-2, kreuz-3, schaufel-10, ecken-unter">
      <button id="btnStart">Fate anzeigen</button>
    </div>

    <div id="errorBox" class="error" style="display:none;"></div>

    <div id="resultBox" class="result" style="display:none;">
      <div id="resultText" class="result-text"></div>
      <div id="resultMeta" class="result-meta"></div>
      <div id="tagList" class="tags"></div>
    </div>
  </div>
</div>

<script>
function getParameter(name) {
  const params = new URLSearchParams(window.location.search);
  return params.get(name);
}

function parseCard(raw) {
  const parts = raw.toLowerCase().trim().split("-");
  if (parts.length !== 2) return null;

  const farbe = parts[0];
  const wert = parts[1];

  const erlaubteFarben = ["herz", "kreuz", "schaufel", "ecken"];
  // volles 52er-Deck: 2‚Äì10 + unter/ober/koenig/ass
  const erlaubteWerte = [
    "2","3","4","5","6","7","8","9","10",
    "unter","ober","koenig","ass"
  ];

  if (!erlaubteFarben.includes(farbe)) return null;
  if (!erlaubteWerte.includes(wert)) return null;

  return { farbe, wert };
}

// Lokale "KI"-Logik
function generateFate(card) {
  const themen = {
    herz: "Beziehungen & Menschen",
    kreuz: "Herausforderungen & Logik",
    schaufel: "Entscheidungen & Verantwortung",
    ecken: "Action & Umsetzung"
  };

  const texte = {
    herz: [
      "Sprich direkt aus, was du meinst.",
      "Eine kurze R√ºckmeldung reicht v√∂llig.",
      "Ein kleiner Kontakt l√∂st schon viel.",
      "Heute helfen einfache, klare Worte."
    ],
    kreuz: [
      "Sortiere erst, handle dann.",
      "Ein Mini-Plan reicht f√ºr heute.",
      "Bleib sachlich, das hilft.",
      "Nicht √ºberdenken ‚Äì leicht strukturieren."
    ],
    schaufel: [
      "Triff eine Entscheidung und geh weiter.",
      "Ein ‚ÄûNein‚Äú spart dir heute Energie.",
      "Halte deinen Fokus eng.",
      "Heute z√§hlt Klarheit mehr als Tempo."
    ],
    ecken: [
      "Starte einfach ‚Äì jetzt.",
      "Mach es kurz und pragmatisch.",
      "Kleine Schritte reichen v√∂llig.",
      "Erledige 1-Minuten-Aufgaben sofort."
    ]
  };

  // Intensit√§t:
  // 2‚Äì7  -> leicht
  // 8‚Äì9  -> mittel
  // 10, Ober, K√∂nig, Ass -> hoch
  const hohe = ["10","ober","koenig","ass"];
  const niedrige = ["2","3","4","5","6","7"];

  let intensitaet = "mittel";
  if (hohe.includes(card.wert)) intensitaet = "hoch";
  if (niedrige.includes(card.wert)) intensitaet = "leicht";

  const intros = {
    leicht: [""],
    mittel: [""],
    hoch: [""]
  };

  const outros = {
    leicht: [""],
    mittel: [""],
    hoch: [""]
  };

  function pick(a) { return a[Math.floor(Math.random() * a.length)]; }

  const thema = themen[card.farbe];
  const text = (pick(intros[intensitaet]) + " " + pick(texte[card.farbe]) + " " + pick(outros[intensitaet])).trim();

  return {
    main: text,
    meta: `Karte: ${card.farbe.toUpperCase()} ¬∑ ${card.wert.toUpperCase()} ¬∑ Thema: ${thema}`,
    tags: [
      `Intensit√§t: ${intensitaet}`,
      `Thema: ${thema}`,
      "Modus: lokal (ohne API)"
    ]
  };
}

function showError(msg) {
  const e = document.getElementById("errorBox");
  e.textContent = msg;
  e.style.display = "block";
  document.getElementById("resultBox").style.display = "none";
}

function hideError() {
  document.getElementById("errorBox").style.display = "none";
}

function showResult(res) {
  const box = document.getElementById("resultBox");
  const text = document.getElementById("resultText");
  const meta = document.getElementById("resultMeta");
  const tags = document.getElementById("tagList");

  text.textContent = res.main;
  meta.textContent = res.meta;

  tags.innerHTML = "";
  res.tags.forEach(t => {
    const span = document.createElement("span");
    span.className = "tag";
    span.textContent = t;
    tags.appendChild(span);
  });

  box.style.display = "block";
}

function runFate() {
  hideError();
  const input = document.getElementById("kartenInput").value.trim();
  const card = parseCard(input);

  if (!card) {
    showError('Bitte gib eine g√ºltige Karte ein ‚Äì z. B. ‚Äûherz-2‚Äú, ‚Äûkreuz-3‚Äú, ‚Äûschaufel-10‚Äú, ‚Äûecken-unter‚Äú.');
    return;
  }

  const result = generateFate(card);
  showResult(result);
}

document.getElementById("btnStart").addEventListener("click", runFate);

// QR-Parameter √ºbernehmen: ?karte=herz-7
const paramCard = getParameter("karte");
if (paramCard) {
  document.getElementById("kartenInput").value = paramCard;
}
</script>

</body>
</html>
